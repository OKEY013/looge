import{u,r as _,j as d,k as m,o as i,c as l,a as s,t as a,F as h,l as g,n as f}from"./index-68db2c1c.js";import{g as v,j as y}from"./index-2f105d3f.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";const k={class:"group-purchase"},M={class:"progress-bar"},w={class:"info"},G=["onClick"],I={__name:"GroupPurchase",setup(b){const c=u(),e=_([]);let n=null;d(async()=>{if(!!!window.localStorage.getItem("userToken")){c.push("/login");return}try{const o=await v();e.value=(o.data||[]).map(t=>({...t,progress:t.progress||0,participants:t.participants||Math.floor(1e4+Math.random()*9e4),timeLeft:t.timeLeft||20})),n=setInterval(()=>{e.value.forEach(t=>{t.progress<100&&(t.progress=Math.min(t.progress+5,100),t.timeLeft=Math.max(t.timeLeft-1,0)),t.participants+=Math.floor(1e4+Math.random()*9e4)})},60*1e3)}catch{e.value=[]}}),m(()=>{n&&clearInterval(n)});async function p(r){try{await y({zoneId:r.id}),alert(`已参与${r.name}`)}catch{alert("参与失败")}}return(r,o)=>(i(),l("div",k,[s("h2",null,a(r.$t("group")),1),(i(!0),l(h,null,g(e.value,t=>(i(),l("div",{key:t.id,class:"zone-card"},[s("h3",null,a(t.name),1),s("div",M,[s("div",{class:"progress",style:f({width:t.progress+"%"})},null,4),s("span",null,a(t.progress)+"%",1)]),s("div",w,[s("span",null,a(r.t("prize"))+"："+a(t.prize),1),s("span",null,"参与人数："+a(t.participants),1),s("span",null,"剩余时间："+a(t.timeLeft)+"分钟",1)]),s("button",{onClick:j=>p(t)},"参与拼团",8,G)]))),128))]))}},S=L(I,[["__scopeId","data-v-c9ea709b"]]);export{S as default};
