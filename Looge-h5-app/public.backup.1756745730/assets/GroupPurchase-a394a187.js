import{_ as u,u as _,r as d,j as m,k as h,o as i,c as l,b as s,t as a,F as g,l as f,n as v}from"./index-305f38e6.js";import{g as y,j as L}from"./index-2f105d3f.js";const k={class:"group-purchase"},M={class:"progress-bar"},b={class:"info"},w=["onClick"],G={__name:"GroupPurchase",setup(I){const c=_(),r=d([]);let n=null;m(async()=>{if(!!!window.localStorage.getItem("userToken")){c.push("/login");return}try{const o=await y();r.value=(o.data||[]).map(t=>({...t,progress:t.progress||0,participants:t.participants||Math.floor(1e4+Math.random()*9e4),timeLeft:t.timeLeft||20})),n=setInterval(()=>{r.value.forEach(t=>{t.progress<100&&(t.progress=Math.min(t.progress+5,100),t.timeLeft=Math.max(t.timeLeft-1,0)),t.participants+=Math.floor(1e4+Math.random()*9e4)})},60*1e3)}catch{r.value=[]}}),h(()=>{n&&clearInterval(n)});async function p(e){try{await L({zoneId:e.id}),alert(`已参与${e.name}`)}catch{alert("参与失败")}}return(e,o)=>(i(),l("div",k,[s("h2",null,a(e.$t("group")),1),(i(!0),l(g,null,f(r.value,t=>(i(),l("div",{key:t.id,class:"zone-card"},[s("h3",null,a(t.name),1),s("div",M,[s("div",{class:"progress",style:v({width:t.progress+"%"})},null,4),s("span",null,a(t.progress)+"%",1)]),s("div",b,[s("span",null,a(e.t("prize"))+"："+a(t.prize),1),s("span",null,"参与人数："+a(t.participants),1),s("span",null,"剩余时间："+a(t.timeLeft)+"分钟",1)]),s("button",{onClick:j=>p(t)},"参与拼团",8,w)]))),128))]))}},P=u(G,[["__scopeId","data-v-c9ea709b"]]);export{P as default};
